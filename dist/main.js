(()=>{"use strict";function e(e=null,l=null){return{value:e,next:l}}function l(l){let n=e(l);return{headNode:n,append:l=>{let t=n;for(;null!==t.next;)t=t.next;t.next=e(l)},prepend:l=>{let t=e(l);console.log(`new head ${t.value}`);let o=e(n.value,n.next);console.log(`old head ${o.value}`),t.next=o,n.value=t.value,n.next=t.next,console.log(`headNode ${n.value}`)},size:()=>{if(null==n.next&&null==n.value)return 0;let e=1,l=n;for(;null!==l.next;)l=l.next,e++;return e},head:()=>n,tail:()=>{let e=n;for(;null!==e.next;)e=e.next;return e},at:e=>{let l=n;for(let n=0;n<e;n++)l=l.next;return l},pop:()=>{null==n.next&&(n.value=null);let e=n,l={};for(;null!==e.next;)l=e,e=e.next;l.next=null},contains:e=>{let l=n;for(;null!==l.next;){if(l.value==e)return!0;l=l.next}return l.value==e},find:e=>{let l=n,t=0;for(;null!==l.next;){if(l.value==e)return t;l=l.next,t++}return l.value==e?t:null},toString:()=>{let e="",l=n;for(;null!==l.next;)e=e.concat(`( ${l.value.key} ) -> `),l=l.next;console.log(e.concat(`( ${l.value.key} ) -> null`))}}}let n=function(e){let n=new Array(e),t=e;const o=l=>{let n=0;for(let t=0;t<l.length;t++)n=(31*n+l.charCodeAt(t))%e;return console.log(`${l} is ${n}`),n},r=(e,l)=>{let n=l,t=0;for(;null!==n.next;){if(console.log(`findvalue.value is ${n.value.key}`),n.value.key==e)return t;n=n.next,t++}return n.value.key==e?t:null},a=()=>{let l=0;for(let t=0;t<e;t++)null==n[t]||(n[t].hasOwnProperty("headNode")?l+=n[t].size():l++);return l};return{myMap:n,hash:o,set:(r,u)=>{let s=o(r);if(console.log(`index is ${s}`),console.log(`key is ${r}`),s<0||s>=e)throw new Error("Trying to access index out of bound");if(.75*e<a()&&(()=>{let l=new Array(t);n.push(...l),e+=t})(),null==n[s]||n[s].key==r)n[s]={key:r,data:u};else if(null!=n[s]){console.log("RUH ROH theres a collision"),console.log(n[s]);let e=n[s];if(null==e.headNode){let t=l(e);t.append({key:r,data:u}),n[s]=t}else n[s].append({key:r,data:u})}},get:l=>{let t=o(l);if(t<0||t>=e)throw new Error("Trying to access index out of bound");if(n[t].key==l)return n[t].data;if(null!=n[t].headNode){let e=r(l,n[t].headNode);return n[t].at(e).value.data}return null},has:l=>{let t=o(l);if(t<0||t>=e)throw new Error("Trying to access index out of bound");return null!=n[t]&&(n[t].key==l||null!=n[t].headNode&&null!=r(l,n[t].headNode))},remove:t=>{let a=o(t);if(a<0||a>=e)throw new Error("Trying to access index out of bound");if(console.log("before:"),n[a].toString(),n[a].key==t&&null==n[a].headNode)return console.log("if not a linked list, just make it undefined"),n[a]=void 0,!0;if(n[a].headNode.value.key!=t||null==n[a].headNode.next){if(null!=n[a].headNode){console.log("if a linked list"),console.log("before:"),n[a].toString();let e=n[a],o=e.headNode,u=r(t,e.headNode);console.log(`i is ${u}`);let s=e.size(),d=l(e.headNode.value);for(let e=1;e<s;e++)e!=u&&d.append(o.next.value),o=o.next;return console.log("after:"),d.toString(),n[a]=d,!0}return!1}console.log("it's the first node"),n[a].headNode.value=n[a].headNode.next.value,n[a].headNode.next=n[a].headNode.next.next,console.log("after:"),n[a].toString()},length:a,clear:()=>{for(i=0;i<e;i++)n[i]=void 0},keys:()=>{let l=[],t=0;for(let o=0;o<e;o++){console.log(`myMap${o} is ${n[o]}`);let e=n[o];if(null==e);else if(e.hasOwnProperty("headNode")){console.log("its a linked list");for(let n=0;n<e.size();n++)l[t]=e.at(n).value.key,t++}else l[t]=e.key,t++}return console.log(l),l},values:()=>{let l=[],t=0;for(let o=0;o<e;o++)if(null==n[o]);else if(n[o].hasOwnProperty("headNode"))for(let e=0;e<n[o].size();e++)l[t]=n[o].at(e).value.data,t++;else null!=n[o].key&&(l[t]=n[o].data,t++);return console.log(l),l},entries:()=>{let l=[],t=0;for(let o=0;o<e;o++)if(null==n[o]);else if(n[o].hasOwnProperty("headNode"))for(let e=0;e<n[o].size();e++)l[t]=[n[o].at(e).value.key,n[o].at(e).value.data],t++;else null!=n[o].key&&(l[t]=[n[o].key,n[o].data],t++);return console.log(l),l}}}(16);n.set("apple","red"),n.set("banana","yellow"),n.set("carrot","orange"),n.set("dog","brown"),n.set("elephant","gray"),n.set("frog","green"),n.set("grape","purple"),n.set("hat","black"),n.set("ice cream","white"),n.set("god","is good"),n.set("kite","pink"),n.set("lion","golden"),console.log(n),console.log(n.length()),n.keys(),console.log(n.length()),n.values(),console.log(n.myMap),n.entries()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFHeUMsR0FBRzFELE1BQU00QixJQUFLRSxFQUFNakIsR0FBR0ksR0FBR3lDLEdBQUcxRCxNQUFNeUMsTUFDaEVZLFNBRXVCZixNQUFoQlIsRUFBTWpCLEdBQUdlLE1BQ2xCa0MsRUFBV1QsR0FBSyxDQUFDdkIsRUFBTWpCLEdBQUdlLElBQUtFLEVBQU1qQixHQUFHNEIsTUFDeENZLEtBSUosT0FEQTVDLFFBQVFDLElBQUlvRCxHQUNMQSxDQUFVLEVBZ0JyQixDQUVXQyxDQUFRLElBQ25CbEMsRUFBS1csSUFBSSxRQUFTLE9BQ2xCWCxFQUFLVyxJQUFJLFNBQVUsVUFDbkJYLEVBQUtXLElBQUksU0FBVSxVQUNuQlgsRUFBS1csSUFBSSxNQUFPLFNBQ2hCWCxFQUFLVyxJQUFJLFdBQVksUUFDckJYLEVBQUtXLElBQUksT0FBUSxTQUNqQlgsRUFBS1csSUFBSSxRQUFTLFVBQ2xCWCxFQUFLVyxJQUFJLE1BQU8sU0FDaEJYLEVBQUtXLElBQUksWUFBYSxTQUN0QlgsRUFBS1csSUFBSSxNQUFPLFdBQ2hCWCxFQUFLVyxJQUFJLE9BQVEsUUFDakJYLEVBQUtXLElBQUksT0FBUSxVQUVqQi9CLFFBQVFDLElBQUltQixHQUNacEIsUUFBUUMsSUFBSW1CLEVBQUtNLFVBTWpCTixFQUFLMEIsT0FDTDlDLFFBQVFDLElBQUltQixFQUFLTSxVQUNqQk4sRUFBSzhCLFNBQ0xsRCxRQUFRQyxJQUFJbUIsRUFBS0MsT0FDakJELEVBQUtnQyxTIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaGFzaG1hcC8uL3NyYy9saXN0cy5qcyIsIndlYnBhY2s6Ly9oYXNobWFwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIG5vZGUodmFsdWUgPSBudWxsLCBuZXh0ID0gbnVsbCkge1xuICByZXR1cm4geyB2YWx1ZTogdmFsdWUsIG5leHQ6IG5leHQgfTtcbn1cblxuZnVuY3Rpb24gbGlua2VkTGlzdChmaXJzdFZhbHVlKSB7XG4gIGxldCBoZWFkTm9kZSA9IG5vZGUoZmlyc3RWYWx1ZSk7XG5cbiAgY29uc3QgYXBwZW5kID0gKHZhbHVlKSA9PiB7XG4gICAgbGV0IGZpbmRUYWlsID0gaGVhZE5vZGU7XG4gICAgd2hpbGUgKGZpbmRUYWlsLm5leHQgIT09IG51bGwpIHtcbiAgICAgIGZpbmRUYWlsID0gZmluZFRhaWwubmV4dDtcbiAgICB9XG4gICAgZmluZFRhaWwubmV4dCA9IG5vZGUodmFsdWUpO1xuICB9O1xuXG4gIGNvbnN0IHByZXBlbmQgPSAodmFsdWUpID0+IHtcbiAgICBsZXQgbmV3SGVhZCA9IG5vZGUodmFsdWUpO1xuICAgIGNvbnNvbGUubG9nKGBuZXcgaGVhZCAke25ld0hlYWQudmFsdWV9YCk7XG4gICAgbGV0IG9sZEhlYWQgPSBub2RlKGhlYWROb2RlLnZhbHVlLCBoZWFkTm9kZS5uZXh0KTtcbiAgICBjb25zb2xlLmxvZyhgb2xkIGhlYWQgJHtvbGRIZWFkLnZhbHVlfWApO1xuICAgIG5ld0hlYWQubmV4dCA9IG9sZEhlYWQ7XG4gICAgaGVhZE5vZGUudmFsdWUgPSBuZXdIZWFkLnZhbHVlO1xuICAgIGhlYWROb2RlLm5leHQgPSBuZXdIZWFkLm5leHQ7XG4gICAgY29uc29sZS5sb2coYGhlYWROb2RlICR7aGVhZE5vZGUudmFsdWV9YCk7XG4gIH07XG5cbiAgY29uc3Qgc2l6ZSA9ICgpID0+IHtcbiAgICBpZiAoaGVhZE5vZGUubmV4dCA9PSBudWxsICYmIGhlYWROb2RlLnZhbHVlID09IG51bGwpIHJldHVybiAwO1xuICAgIGxldCBpID0gMTtcbiAgICBsZXQgY291bnRlciA9IGhlYWROb2RlO1xuICAgIHdoaWxlIChjb3VudGVyLm5leHQgIT09IG51bGwpIHtcbiAgICAgIGNvdW50ZXIgPSBjb3VudGVyLm5leHQ7XG4gICAgICBpKys7XG4gICAgfVxuICAgIHJldHVybiBpO1xuICB9O1xuXG4gIGNvbnN0IGhlYWQgPSAoKSA9PiB7XG4gICAgcmV0dXJuIGhlYWROb2RlO1xuICB9O1xuXG4gIGNvbnN0IHRhaWwgPSAoKSA9PiB7XG4gICAgbGV0IGZpbmRUYWlsID0gaGVhZE5vZGU7XG4gICAgd2hpbGUgKGZpbmRUYWlsLm5leHQgIT09IG51bGwpIHtcbiAgICAgIGZpbmRUYWlsID0gZmluZFRhaWwubmV4dDtcbiAgICB9XG4gICAgcmV0dXJuIGZpbmRUYWlsO1xuICB9O1xuXG4gIGNvbnN0IGF0ID0gKGluZGV4KSA9PiB7XG4gICAgbGV0IHBvaW50ZXIgPSBoZWFkTm9kZTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluZGV4OyBpKyspIHtcbiAgICAgIHBvaW50ZXIgPSBwb2ludGVyLm5leHQ7XG4gICAgfVxuICAgIHJldHVybiBwb2ludGVyO1xuICB9O1xuXG4gIGNvbnN0IHBvcCA9ICgpID0+IHtcbiAgICBpZiAoaGVhZE5vZGUubmV4dCA9PSBudWxsKSBoZWFkTm9kZS52YWx1ZSA9IG51bGw7XG4gICAgbGV0IGZpbmRUYWlsID0gaGVhZE5vZGU7XG4gICAgbGV0IG5ld1RhaWwgPSB7fTtcbiAgICB3aGlsZSAoZmluZFRhaWwubmV4dCAhPT0gbnVsbCkge1xuICAgICAgbmV3VGFpbCA9IGZpbmRUYWlsO1xuICAgICAgZmluZFRhaWwgPSBmaW5kVGFpbC5uZXh0O1xuICAgIH1cbiAgICBuZXdUYWlsLm5leHQgPSBudWxsO1xuICB9O1xuXG4gIGNvbnN0IGNvbnRhaW5zID0gKHZhbHVlKSA9PiB7XG4gICAgbGV0IGZpbmRWYWx1ZSA9IGhlYWROb2RlO1xuICAgIHdoaWxlIChmaW5kVmFsdWUubmV4dCAhPT0gbnVsbCkge1xuICAgICAgaWYgKGZpbmRWYWx1ZS52YWx1ZSA9PSB2YWx1ZSkgcmV0dXJuIHRydWU7XG4gICAgICBmaW5kVmFsdWUgPSBmaW5kVmFsdWUubmV4dDtcbiAgICB9XG4gICAgcmV0dXJuIGZpbmRWYWx1ZS52YWx1ZSA9PSB2YWx1ZTtcbiAgfTtcblxuICBjb25zdCBmaW5kID0gKHZhbHVlKSA9PiB7XG4gICAgbGV0IGZpbmRWYWx1ZSA9IGhlYWROb2RlO1xuICAgIGxldCBpID0gMDtcbiAgICB3aGlsZSAoZmluZFZhbHVlLm5leHQgIT09IG51bGwpIHtcbiAgICAgIGlmIChmaW5kVmFsdWUudmFsdWUgPT0gdmFsdWUpIHJldHVybiBpO1xuICAgICAgZmluZFZhbHVlID0gZmluZFZhbHVlLm5leHQ7XG4gICAgICBpKys7XG4gICAgfVxuICAgIGlmIChmaW5kVmFsdWUudmFsdWUgPT0gdmFsdWUpIHJldHVybiBpO1xuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIGNvbnN0IHRvU3RyaW5nID0gKCkgPT4ge1xuICAgIGxldCB0b1ByaW50ID0gXCJcIjtcbiAgICBsZXQgZmluZFZhbHVlID0gaGVhZE5vZGU7XG4gICAgd2hpbGUgKGZpbmRWYWx1ZS5uZXh0ICE9PSBudWxsKSB7XG4gICAgICB0b1ByaW50ID0gdG9QcmludC5jb25jYXQoYCggJHtmaW5kVmFsdWUudmFsdWUua2V5fSApIC0+IGApO1xuICAgICAgZmluZFZhbHVlID0gZmluZFZhbHVlLm5leHQ7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2codG9QcmludC5jb25jYXQoYCggJHtmaW5kVmFsdWUudmFsdWUua2V5fSApIC0+IG51bGxgKSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBoZWFkTm9kZSxcbiAgICBhcHBlbmQsXG4gICAgcHJlcGVuZCxcbiAgICBzaXplLFxuICAgIGhlYWQsXG4gICAgdGFpbCxcbiAgICBhdCxcbiAgICBwb3AsXG4gICAgY29udGFpbnMsXG4gICAgZmluZCxcbiAgICB0b1N0cmluZyxcbiAgfTtcbn1cblxuZXhwb3J0IHsgbm9kZSwgbGlua2VkTGlzdCB9O1xuIiwiaW1wb3J0IHsgbm9kZSwgbGlua2VkTGlzdCB9IGZyb20gXCIuL2xpc3RzLmpzXCI7XG5cbmZ1bmN0aW9uIEhhc2hNYXAoc2l6ZSkge1xuICBsZXQgbXlNYXAgPSBuZXcgQXJyYXkoc2l6ZSk7XG4gIGxldCBvcmlnU2l6ZSA9IHNpemU7XG4gIGxldCBsb2FkRmFjdG9yID0gMC43NTtcblxuICBjb25zdCBoYXNoID0gKGtleSkgPT4ge1xuICAgIGxldCBoYXNoQ29kZSA9IDA7XG5cbiAgICBjb25zdCBwcmltZU51bWJlciA9IDMxO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBoYXNoQ29kZSA9IChwcmltZU51bWJlciAqIGhhc2hDb2RlICsga2V5LmNoYXJDb2RlQXQoaSkpICUgc2l6ZTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coYCR7a2V5fSBpcyAke2hhc2hDb2RlfWApO1xuICAgIHJldHVybiBoYXNoQ29kZTtcbiAgfTtcblxuICBjb25zdCBleHBhbmQgPSAoKSA9PiB7XG4gICAgbGV0IGFkZE9uID0gbmV3IEFycmF5KG9yaWdTaXplKTtcbiAgICBteU1hcC5wdXNoKC4uLmFkZE9uKTtcbiAgICBzaXplICs9IG9yaWdTaXplO1xuICB9O1xuXG4gIC8vd29ya3NcbiAgY29uc3Qgc2V0ID0gKGtleSwgZGF0YSkgPT4ge1xuICAgIGxldCBpbmRleCA9IGhhc2goa2V5KTtcbiAgICBjb25zb2xlLmxvZyhgaW5kZXggaXMgJHtpbmRleH1gKTtcbiAgICBjb25zb2xlLmxvZyhga2V5IGlzICR7a2V5fWApO1xuICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gc2l6ZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVHJ5aW5nIHRvIGFjY2VzcyBpbmRleCBvdXQgb2YgYm91bmRcIik7XG4gICAgfVxuICAgIGlmIChzaXplICogbG9hZEZhY3RvciA8IGxlbmd0aCgpKSBleHBhbmQoKTtcblxuICAgIGlmIChteU1hcFtpbmRleF0gPT0gdW5kZWZpbmVkIHx8IG15TWFwW2luZGV4XS5rZXkgPT0ga2V5KSB7XG4gICAgICBteU1hcFtpbmRleF0gPSB7IGtleSwgZGF0YSB9O1xuICAgIH0gZWxzZSBpZiAobXlNYXBbaW5kZXhdICE9IHVuZGVmaW5lZCkge1xuICAgICAgY29uc29sZS5sb2coXCJSVUggUk9IIHRoZXJlcyBhIGNvbGxpc2lvblwiKTtcbiAgICAgIGNvbnNvbGUubG9nKG15TWFwW2luZGV4XSk7XG5cbiAgICAgIGxldCBkYXRhSW5CdWNrZXQgPSBteU1hcFtpbmRleF07XG5cbiAgICAgIGlmIChkYXRhSW5CdWNrZXQuaGVhZE5vZGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vbmVlZCB0byBjb252ZXJ0IHRvIGxpbmtlZCBsaXN0XG4gICAgICAgIGxldCBuZXdMaXN0ID0gbGlua2VkTGlzdChkYXRhSW5CdWNrZXQpO1xuICAgICAgICBuZXdMaXN0LmFwcGVuZCh7IGtleSwgZGF0YSB9KTtcbiAgICAgICAgbXlNYXBbaW5kZXhdID0gbmV3TGlzdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vaXQncyBhbHJlYWR5IGEgbGlua2VkIGxpc3RcbiAgICAgICAgbXlNYXBbaW5kZXhdLmFwcGVuZCh7IGtleSwgZGF0YSB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLy93b3Jrc1xuICBjb25zdCBnZXQgPSAoa2V5KSA9PiB7XG4gICAgbGV0IGluZGV4ID0gaGFzaChrZXkpO1xuICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gc2l6ZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVHJ5aW5nIHRvIGFjY2VzcyBpbmRleCBvdXQgb2YgYm91bmRcIik7XG4gICAgfVxuICAgIGlmIChteU1hcFtpbmRleF0ua2V5ID09IGtleSkge1xuICAgICAgcmV0dXJuIG15TWFwW2luZGV4XS5kYXRhO1xuICAgIH0gZWxzZSBpZiAobXlNYXBbaW5kZXhdLmhlYWROb2RlICE9IHVuZGVmaW5lZCkge1xuICAgICAgbGV0IGkgPSBmaW5kKGtleSwgbXlNYXBbaW5kZXhdLmhlYWROb2RlKTtcbiAgICAgIHJldHVybiBteU1hcFtpbmRleF0uYXQoaSkudmFsdWUuZGF0YTtcbiAgICB9IGVsc2UgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgY29uc3QgaGFzID0gKGtleSkgPT4ge1xuICAgIGxldCBpbmRleCA9IGhhc2goa2V5KTtcbiAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHNpemUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyeWluZyB0byBhY2Nlc3MgaW5kZXggb3V0IG9mIGJvdW5kXCIpO1xuICAgIH1cbiAgICBpZiAobXlNYXBbaW5kZXhdID09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlO1xuICAgIGVsc2UgaWYgKG15TWFwW2luZGV4XS5rZXkgPT0ga2V5KSByZXR1cm4gdHJ1ZTtcbiAgICBlbHNlIGlmIChteU1hcFtpbmRleF0uaGVhZE5vZGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoZmluZChrZXksIG15TWFwW2luZGV4XS5oZWFkTm9kZSkgIT0gbnVsbCkgcmV0dXJuIHRydWU7XG4gICAgICBlbHNlIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2UgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIC8vd29ya3MsIGJ1dCB3aGF0IGlmIHdlIHJlbW92ZSB0aGUgbGFzdCBvbmUgaW4gTEw/Pz9cbiAgY29uc3QgcmVtb3ZlID0gKGtleSkgPT4ge1xuICAgIGxldCBpbmRleCA9IGhhc2goa2V5KTtcbiAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHNpemUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyeWluZyB0byBhY2Nlc3MgaW5kZXggb3V0IG9mIGJvdW5kXCIpO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhcImJlZm9yZTpcIik7XG4gICAgbXlNYXBbaW5kZXhdLnRvU3RyaW5nKCk7XG4gICAgaWYgKG15TWFwW2luZGV4XS5rZXkgPT0ga2V5ICYmIG15TWFwW2luZGV4XS5oZWFkTm9kZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vaWYgbm90IGEgbGlua2VkIGxpc3QsIGp1c3QgbWFrZSBpdCB1bmRlZmluZWRcbiAgICAgIGNvbnNvbGUubG9nKFwiaWYgbm90IGEgbGlua2VkIGxpc3QsIGp1c3QgbWFrZSBpdCB1bmRlZmluZWRcIik7XG4gICAgICBteU1hcFtpbmRleF0gPSB1bmRlZmluZWQ7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKFxuICAgICAgbXlNYXBbaW5kZXhdLmhlYWROb2RlLnZhbHVlLmtleSA9PSBrZXkgJiZcbiAgICAgIG15TWFwW2luZGV4XS5oZWFkTm9kZS5uZXh0ICE9IHVuZGVmaW5lZFxuICAgICkge1xuICAgICAgLy9pZiBpdCBpcyBhIGxpbmtlZCBsaXN0IGFuZCBpdCdzIHRoZSBmaXJzdCBub2RlXG4gICAgICBjb25zb2xlLmxvZyhgaXQncyB0aGUgZmlyc3Qgbm9kZWApO1xuICAgICAgbXlNYXBbaW5kZXhdLmhlYWROb2RlLnZhbHVlID0gbXlNYXBbaW5kZXhdLmhlYWROb2RlLm5leHQudmFsdWU7XG4gICAgICBteU1hcFtpbmRleF0uaGVhZE5vZGUubmV4dCA9IG15TWFwW2luZGV4XS5oZWFkTm9kZS5uZXh0Lm5leHQ7XG4gICAgICBjb25zb2xlLmxvZyhcImFmdGVyOlwiKTtcbiAgICAgIG15TWFwW2luZGV4XS50b1N0cmluZygpO1xuICAgIH0gZWxzZSBpZiAobXlNYXBbaW5kZXhdLmhlYWROb2RlICE9IHVuZGVmaW5lZCkge1xuICAgICAgLy9pZiBhIGxpbmtlZCBsaXN0IGJ1dCBOT1QgdGhlIGZpcnN0IG5vZGVcblxuICAgICAgY29uc29sZS5sb2coXCJpZiBhIGxpbmtlZCBsaXN0XCIpO1xuICAgICAgY29uc29sZS5sb2coXCJiZWZvcmU6XCIpO1xuICAgICAgbXlNYXBbaW5kZXhdLnRvU3RyaW5nKCk7XG4gICAgICBsZXQgbXlMaXN0ID0gbXlNYXBbaW5kZXhdO1xuICAgICAgbGV0IGZpbmRlciA9IG15TGlzdC5oZWFkTm9kZTtcbiAgICAgIGxldCBpID0gZmluZChrZXksIG15TGlzdC5oZWFkTm9kZSk7XG4gICAgICBjb25zb2xlLmxvZyhgaSBpcyAke2l9YCk7XG4gICAgICBsZXQgc2l6ZSA9IG15TGlzdC5zaXplKCk7XG5cbiAgICAgIC8vbWFrZSB0aGUgaGVhZG5vZGUsIGFzc3VtaW5nIGl0cyBub3Qgd2hhdCB3ZSdyZSByZW1vdmluZ1xuICAgICAgbGV0IG5ld0xpc3QgPSBsaW5rZWRMaXN0KG15TGlzdC5oZWFkTm9kZS52YWx1ZSk7XG5cbiAgICAgIGZvciAobGV0IGsgPSAxOyBrIDwgc2l6ZTsgaysrKSB7XG4gICAgICAgIGlmIChrICE9IGkpIHtcbiAgICAgICAgICBuZXdMaXN0LmFwcGVuZChmaW5kZXIubmV4dC52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZmluZGVyID0gZmluZGVyLm5leHQ7XG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZyhcImFmdGVyOlwiKTtcbiAgICAgIG5ld0xpc3QudG9TdHJpbmcoKTtcbiAgICAgIG15TWFwW2luZGV4XSA9IG5ld0xpc3Q7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2UgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IGZpbmQgPSAodmFsdWUsIGhlYWROb2RlKSA9PiB7XG4gICAgbGV0IGZpbmRWYWx1ZSA9IGhlYWROb2RlO1xuICAgIGxldCBpID0gMDtcbiAgICB3aGlsZSAoZmluZFZhbHVlLm5leHQgIT09IG51bGwpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBmaW5kdmFsdWUudmFsdWUgaXMgJHtmaW5kVmFsdWUudmFsdWUua2V5fWApO1xuICAgICAgaWYgKGZpbmRWYWx1ZS52YWx1ZS5rZXkgPT0gdmFsdWUpIHJldHVybiBpO1xuICAgICAgZmluZFZhbHVlID0gZmluZFZhbHVlLm5leHQ7XG4gICAgICBpKys7XG4gICAgfVxuICAgIGlmIChmaW5kVmFsdWUudmFsdWUua2V5ID09IHZhbHVlKSByZXR1cm4gaTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICBjb25zdCBsZW5ndGggPSAoKSA9PiB7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgaWYgKG15TWFwW2ldID09IHVuZGVmaW5lZCkge1xuICAgICAgICAvL2Rvbm90aGluZ1xuICAgICAgfSBlbHNlIGlmIChteU1hcFtpXS5oYXNPd25Qcm9wZXJ0eShcImhlYWROb2RlXCIpKSB7XG4gICAgICAgIGNvdW50ICs9IG15TWFwW2ldLnNpemUoKTtcbiAgICAgIH0gZWxzZSBjb3VudCsrO1xuICAgIH1cbiAgICByZXR1cm4gY291bnQ7XG4gIH07XG5cbiAgY29uc3QgY2xlYXIgPSAoKSA9PiB7XG4gICAgZm9yIChpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgbXlNYXBbaV0gPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGtleXMgPSAoKSA9PiB7XG4gICAgbGV0IGFsbEtleXMgPSBbXTtcbiAgICBsZXQgayA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgIGNvbnNvbGUubG9nKGBteU1hcCR7aX0gaXMgJHtteU1hcFtpXX1gKTtcbiAgICAgIGxldCBidWNrZXQgPSBteU1hcFtpXTtcbiAgICAgIGlmIChidWNrZXQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8qZG8gbm90aGluZyAqL1xuICAgICAgfSBlbHNlIGlmIChidWNrZXQuaGFzT3duUHJvcGVydHkoXCJoZWFkTm9kZVwiKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIml0cyBhIGxpbmtlZCBsaXN0XCIpO1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJ1Y2tldC5zaXplKCk7IGorKykge1xuICAgICAgICAgIGFsbEtleXNba10gPSBidWNrZXQuYXQoaikudmFsdWUua2V5O1xuICAgICAgICAgIGsrKztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWxsS2V5c1trXSA9IGJ1Y2tldC5rZXk7XG4gICAgICAgIGsrKztcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc29sZS5sb2coYWxsS2V5cyk7XG4gICAgcmV0dXJuIGFsbEtleXM7XG4gIH07XG5cbiAgY29uc3QgdmFsdWVzID0gKCkgPT4ge1xuICAgIGxldCBhbGxWYWx1ZXMgPSBbXTtcbiAgICBsZXQgayA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgIGlmIChteU1hcFtpXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy9kbyBub3RoaW5nXG4gICAgICB9IGVsc2UgaWYgKG15TWFwW2ldLmhhc093blByb3BlcnR5KFwiaGVhZE5vZGVcIikpIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBteU1hcFtpXS5zaXplKCk7IGorKykge1xuICAgICAgICAgIGFsbFZhbHVlc1trXSA9IG15TWFwW2ldLmF0KGopLnZhbHVlLmRhdGE7XG4gICAgICAgICAgaysrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG15TWFwW2ldLmtleSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgYWxsVmFsdWVzW2tdID0gbXlNYXBbaV0uZGF0YTtcbiAgICAgICAgaysrO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhhbGxWYWx1ZXMpO1xuICAgIHJldHVybiBhbGxWYWx1ZXM7XG4gIH07XG5cbiAgY29uc3QgZW50cmllcyA9ICgpID0+IHtcbiAgICBsZXQgYWxsRW50cmllcyA9IFtdO1xuICAgIGxldCBrID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgaWYgKG15TWFwW2ldID09IHVuZGVmaW5lZCkge1xuICAgICAgICAvL2RvIG5vdGhpbmdcbiAgICAgIH0gZWxzZSBpZiAobXlNYXBbaV0uaGFzT3duUHJvcGVydHkoXCJoZWFkTm9kZVwiKSkge1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG15TWFwW2ldLnNpemUoKTsgaisrKSB7XG4gICAgICAgICAgYWxsRW50cmllc1trXSA9IFtteU1hcFtpXS5hdChqKS52YWx1ZS5rZXksIG15TWFwW2ldLmF0KGopLnZhbHVlLmRhdGFdO1xuICAgICAgICAgIGsrKztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChteU1hcFtpXS5rZXkgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGFsbEVudHJpZXNba10gPSBbbXlNYXBbaV0ua2V5LCBteU1hcFtpXS5kYXRhXTtcbiAgICAgICAgaysrO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhhbGxFbnRyaWVzKTtcbiAgICByZXR1cm4gYWxsRW50cmllcztcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIG15TWFwLFxuICAgIGhhc2gsXG4gICAgc2V0LFxuICAgIGdldCxcbiAgICBoYXMsXG4gICAgcmVtb3ZlLFxuICAgIGxlbmd0aCxcbiAgICBjbGVhcixcbiAgICBrZXlzLFxuICAgIHZhbHVlcyxcbiAgICBlbnRyaWVzLFxuICB9O1xufVxuXG5sZXQgdGVzdCA9IEhhc2hNYXAoMTYpO1xudGVzdC5zZXQoXCJhcHBsZVwiLCBcInJlZFwiKTtcbnRlc3Quc2V0KFwiYmFuYW5hXCIsIFwieWVsbG93XCIpO1xudGVzdC5zZXQoXCJjYXJyb3RcIiwgXCJvcmFuZ2VcIik7XG50ZXN0LnNldChcImRvZ1wiLCBcImJyb3duXCIpO1xudGVzdC5zZXQoXCJlbGVwaGFudFwiLCBcImdyYXlcIik7XG50ZXN0LnNldChcImZyb2dcIiwgXCJncmVlblwiKTtcbnRlc3Quc2V0KFwiZ3JhcGVcIiwgXCJwdXJwbGVcIik7XG50ZXN0LnNldChcImhhdFwiLCBcImJsYWNrXCIpO1xudGVzdC5zZXQoXCJpY2UgY3JlYW1cIiwgXCJ3aGl0ZVwiKTtcbnRlc3Quc2V0KFwiZ29kXCIsIFwiaXMgZ29vZFwiKTtcbnRlc3Quc2V0KFwia2l0ZVwiLCBcInBpbmtcIik7XG50ZXN0LnNldChcImxpb25cIiwgXCJnb2xkZW5cIik7XG5cbmNvbnNvbGUubG9nKHRlc3QpO1xuY29uc29sZS5sb2codGVzdC5sZW5ndGgoKSk7XG4vLyBjb25zb2xlLmxvZyh0ZXN0LmdldChcImZyb2dcIikpO1xuLy8gY29uc29sZS5sb2codGVzdC5nZXQoXCJnb2RcIikpO1xuLy8gdGVzdC5yZW1vdmUoXCJsaW9uXCIpO1xuLy8gY29uc29sZS5sb2codGVzdCk7XG4vLyBjb25zb2xlLmxvZyhgaGFzIGljZSBjcmVhbT8gJHt0ZXN0LmhhcyhcImljZSBjcmVhbVwiKX1gKTtcbnRlc3Qua2V5cygpO1xuY29uc29sZS5sb2codGVzdC5sZW5ndGgoKSk7XG50ZXN0LnZhbHVlcygpO1xuY29uc29sZS5sb2codGVzdC5teU1hcCk7XG50ZXN0LmVudHJpZXMoKTtcbiJdLCJuYW1lcyI6WyJub2RlIiwidmFsdWUiLCJuZXh0IiwibGlua2VkTGlzdCIsImZpcnN0VmFsdWUiLCJoZWFkTm9kZSIsImFwcGVuZCIsImZpbmRUYWlsIiwicHJlcGVuZCIsIm5ld0hlYWQiLCJjb25zb2xlIiwibG9nIiwib2xkSGVhZCIsInNpemUiLCJpIiwiY291bnRlciIsImhlYWQiLCJ0YWlsIiwiYXQiLCJpbmRleCIsInBvaW50ZXIiLCJwb3AiLCJuZXdUYWlsIiwiY29udGFpbnMiLCJmaW5kVmFsdWUiLCJmaW5kIiwidG9TdHJpbmciLCJ0b1ByaW50IiwiY29uY2F0Iiwia2V5IiwidGVzdCIsIm15TWFwIiwiQXJyYXkiLCJvcmlnU2l6ZSIsImhhc2giLCJoYXNoQ29kZSIsImxlbmd0aCIsImNoYXJDb2RlQXQiLCJjb3VudCIsInVuZGVmaW5lZCIsImhhc093blByb3BlcnR5Iiwic2V0IiwiZGF0YSIsIkVycm9yIiwiYWRkT24iLCJwdXNoIiwiZXhwYW5kIiwiZGF0YUluQnVja2V0IiwibmV3TGlzdCIsImdldCIsImhhcyIsInJlbW92ZSIsIm15TGlzdCIsImZpbmRlciIsImsiLCJjbGVhciIsImtleXMiLCJhbGxLZXlzIiwiYnVja2V0IiwiaiIsInZhbHVlcyIsImFsbFZhbHVlcyIsImVudHJpZXMiLCJhbGxFbnRyaWVzIiwiSGFzaE1hcCJdLCJzb3VyY2VSb290IjoiIn0=